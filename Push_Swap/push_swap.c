/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   Push_swap.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: Gfinet <gfinet@student.s19.be>             +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2023/12/13 17:21:32 by gfinet            #+#    #+#             */
/*   Updated: 2024/01/31 10:10:25 by Gfinet           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "push_swap.h"

//fill the a pile with all char number translate into int number.

static int	fill_a(t_nlst_head *a, char **arg, int nb_arg)
{
	t_nlst	*p;
	int		i;

	i = 0;
	while (i < nb_arg)
	{
		p = ft_nlstnew(ft_atoi(arg[i]));
		if (!p)
			return (ft_nlstclear(a, free));
		ft_nlstadd_back(a, p);
		i++;
	}
	return (1);
}

//Function wich sort little amount of number (less than 6)

static void	sort_little(t_nlst_head *a, t_nlst_head *b, int n)
{
	if (check_heap(a->first, 0))
		return ;
	if (n == 2 && !check_heap(a->first, 0))
		rotate(a, 0, 0);
	else if (n == 3)
	{
		sort_3(a, 0);
		rot_to_first(a, nlst_get_low_big(a, 0), 3, 0);
	}
	else
	{
		if (nlst_get_place(a, nlst_get_low_big(a, 0)) <= n / 2)
			while (!check_first(a, 0))
				rotate(a, 0, 0);
		else
			while (!check_first(a, 0))
				reverse_rotate(a, 0, 0);
		if (!check_heap(a->first, 0))
		{
			push(a, b, 1);
			sort_little(a, b, n - 1);
			push(b, a, 0);
		}
	}
}

t_2_int	*push_swap(char **arg, int nb_arg)
{
	t_nlst_head		*a;
	t_nlst_head		*b;
	t_2_int			*res;

	nlst_head_init(&a);
	nlst_head_init(&b);
	res_init(&res);
	if (!fill_a(a, arg, nb_arg))
		return (res);
	a->lower = nlst_get_low_big(a, 0);
	if (ft_nlstsize(a) > 5)
		opti_push(a, b, 0);
	else if (ft_nlstsize(a) == 3)
	{
		sort_3(a, 0);
		rot_to_first(a, nlst_get_low_big(a, 0), 3, 0);
	}
	else
		sort_little(a, b, ft_nlstsize(a));
	res->one = nlst_compute_moves(a);
	res->two = check_heap(a->first, 0);
	ft_nlstclear(a, free);
	ft_nlstclear(b, free);
	return (res);
}

/*
417 241 19 18 105 59 452 40 131 373 277 229 177 260 319 36 209 62 147 49 358 140 12 186 371 377 341 199 162 484 225 332 288 96 145 393 244 91 69 116 24 369 182 127 183 161 135 351 307 347 463 490 119 80 275 200 17 390 223 234 284 157 13 392 129 148 78 486 159 415 41 445 20 492 289 489 138 290 236 301 50 262 274 326 9 294 185 378 268 387 325 233 153 397 306 188 184 122 434 255 405 296 374 26 323 303 321 467 254 221 195 79 115 10 335 6 317 292 366 90 174 456 156 46 215 57 344 16 465 391 58 429 368 408 293 38 154 33 385 52 402 365 273 462 491 237 480 22 338 133 168 430 205 348 193 85 403 362 121 1 120 400 28 173 473 345 130 2 172 431 439 239 110 251 451 56 187 68 382 203 5 247 428 123 453 446 245 412 31 302 380 396 477 426 499 265 346 32 219 422 357 454 125 469 256 216 343 410 475 208 270 47 194 450 76 389 37 175 217 438 401 257 342 197 258 83 278 226 93 224 192 134 427 334 21 388 458 487 190 298 3 299 266 330 250 212 117 361 64 136 259 356 370 404 146 494 314 423 464 104 253 70 60 248 376 364 488 42 310 360 103 329 395 151 418 111 324 311 15 315 263 34 191 75 309 98 107 176 264 150 35 71 201 87 144 280 14 355 440 114 249 483 8 29 340 363 479 4 48 432 66 213 39 285 421 457 425 65 336 23 170 272 181 496 137 271 94 158 108 54 63 252 455 169 279 84 459 493 447 331 286 295 379 337 30 43 466 411 232 82 367 322 86 81 211 167 416 88 202 495 407 409 67 207 77 204 354 113 478 218 246 92 313 413 25 500 112 100 372 235 55 305 287 141 74 436 304 419 359 149 482 220 297 165 461 352 269 375 163 316 276 189 384 406 109 171 444 152 139 349 442 320 214 95 61 242 227 210 128 327 282 7 102 474 460 72 333 353 433 196 441 424 178 414 222 398 328 179 243 261 476 101 497 481 97 231 470 89 472 468 386 206 485 443 381 240 230 160 448 449 198 394 498 45 143 53 155 291 267 420 51 124 44 228 399 281 283 312 471 339 308 350 166 318 180 435 126 11 437 383 99 106 300 132 73 164 238 118 142 27
7377 moves
*/